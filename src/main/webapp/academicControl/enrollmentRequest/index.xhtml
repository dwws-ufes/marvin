<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
   xmlns:ui="http://java.sun.com/jsf/facelets"
   xmlns:f="http://java.sun.com/jsf/core"
   xmlns:h="http://java.sun.com/jsf/html"
   xmlns:p="http://primefaces.org/ui"
   xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
   xmlns:adm="http://github.com/adminfaces"
   template="/WEB-INF/templates/template.xhtml">
   <ui:define name="title">
      <h:outputText value="#{msgsAcademicControl['enrollmentRequest.title']}" />
   </ui:define>
   <ui:define name="description">
      <h:outputText value="#{msgsAcademicControl['enrollmentRequest.title.description']}" />
   </ui:define>
   <ui:define name="body">
      <!-- The breadcrumb. -->
      <adm:breadcrumb title="#{msgsAcademicControl['enrollmentRequest.title']}" link="index.xhtml" />
      <!-- The listing form. -->
      <ui:decorate template="/WEB-INF/templates/form-nobox.xhtml">
         <ui:param name="formName" value="listingForm" />
         <p:dataTable
            widgetVar="listingTable"
            value="#{enrollmentRequestController.lazyEntities}" 
            var="entity" 
            rows="#{enrollmentRequestController.maxDataTableRowsPerPage}" 
            rowsPerPageTemplate="#{enrollmentRequestController.halfMaxDataTableRowsPerPage},#{enrollmentRequestController.maxDataTableRowsPerPage},#{enrollmentRequestController.doubleMaxDataTableRowsPerPage}"
            lazy="true" 
            paginator="true" 
            selection="#{enrollmentRequestController.selectedEntity}" 
            selectionMode="single" 
            paginatorPosition="bottom" 
            loadingMessage="#{msgs['jbutler.text.ajax.loading']}" 
            emptyMessage="#{enrollmentRequestController.filtering ? msgsAcademicControl['enrollmentRequest.text.noEntitiesFiltered'] : msgsAcademicControl['enrollmentRequest.text.noEntities']}">
            <p:column headerText="#{msgsAcademicControl['enrollmentRequest.field.subjectOffer.period']}">
               <h:outputText value="#{entity.subjectOffer.period.name}" />
            </p:column>
            <p:column headerText="#{msgsAcademicControl['enrollmentRequest.field.subjectOffer.schoolSubject']}">
               <h:outputText value="#{entity.subjectOffer.schoolSubject.name}" />
            </p:column>
            <p:column headerText="#{msgsAcademicControl['enrollmentRequest.field.subjectOffer.professor']}">
               <h:outputText value="#{entity.subjectOffer.professor.name}" />
            </p:column>
            <p:column headerText="#{msgsAcademicControl['enrollmentRequest.field.enrollmentRequestSituation']}">
               <h:outputText value="#{entity.enrollmentRequestSituation.code}" />
            </p:column>
            <p:column headerText="#{msgsAcademicControl['enrollmentRequest.field.note']}">
               <h:outputText value="#{entity.note}" />
            </p:column>
            <p:ajax event="rowSelect" update=":listingForm:buttonsGroup" />
            <p:ajax event="rowUnselect" update=":listingForm:buttonsGroup" />
         </p:dataTable>
         <!-- Buttons shown below the listing. -->
         <h:panelGroup id="buttonsGroup">
            <ui:decorate template="/WEB-INF/templates/formbuttonpanel.xhtml">
               <p:commandButton id="startOverButton" action="#{enrollmentRequestController.startRequest}" value="#{msgsAcademicControl['request.button.request']}" icon="fa fa-fw fa-refresh" />
               <p:commandButton action="#{enrollmentRequestController.retrieve}" value="#{msgs['jbutler.crud.button.retrieve']}" icon="fa fa-fw fa-file-text" disabled="#{enrollmentRequestController.selectedEntity == null}" />
               <p:commandButton action="#{enrollmentRequestController.update}" value="#{msgs['jbutler.crud.button.update']}" icon="fa fa-fw fa-refresh" disabled="#{enrollmentRequestController.selectedEntity == null}" />
               <p:commandButton action="#{enrollmentRequestController.trash}" value="#{msgs['jbutler.crud.button.delete']}" icon="fa fa-fw fa-trash-o" disabled="#{enrollmentRequestController.selectedEntity == null}" process="@this" update="trashGroup" />
            </ui:decorate>
         </h:panelGroup>
         <!-- The trash panel: shows entities that have been selected for deletion. -->
         <h:panelGroup id="trashGroup">
            <p:panel id="trashPanel" header="#{msgs['jbutler.crud.text.trashHeader']}" rendered="#{not empty enrollmentRequestController.trashCan}" style="margin-top: 20px">
               <p:dataList value="#{enrollmentRequestController.trashCan}" var="entity" type="ordered">
                  #{entity.subjectOffer.period.name} #{entity.subjectOffer.schoolSubject.name} #{entity.subjectOffer.professor.name} #{entity.enrollmentRequestSituation} #{entity.note}
               </p:dataList>
               <ui:decorate template="/WEB-INF/templates/formbuttonpanel.xhtml">
                  <p:commandButton action="#{enrollmentRequestController.cancelDeletion}" value="#{msgs['jbutler.crud.button.cancelDeletion']}" icon="fa fa-fw fa-close" process="@this" update=":listingForm" />
                  <p:commandButton action="#{enrollmentRequestController.delete}" value="#{msgs['jbutler.crud.button.confirmDeletion']}" icon="fa fa-fw fa-trash-o" process="@this" update=":messages :info-messages :listingForm" />
               </ui:decorate>
            </p:panel>
         </h:panelGroup>
      </ui:decorate>
   </ui:define>
</ui:composition>