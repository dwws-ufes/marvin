<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
   xmlns:ui="http://java.sun.com/jsf/facelets"
   xmlns:f="http://java.sun.com/jsf/core"
   xmlns:h="http://java.sun.com/jsf/html"
   xmlns:p="http://primefaces.org/ui"
   xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
   xmlns:adm="http://github.com/adminfaces"
   template="/WEB-INF/templates/template.xhtml">
   <ui:define name="title">
      <h:outputText value="#{msgsAcademicControl['enrollmentRequest.title']}" />
   </ui:define>
   <ui:define name="description">
      <h:outputText value="#{msgsAcademicControl['enrollmentRequest.title.description']}" />
   </ui:define>
   <f:metadata>
      <f:viewAction action="#{enrollmentRequestController.onLoad}" />
   </f:metadata>
   <ui:define name="body">
      <!-- The breadcrumb. -->
      <adm:breadcrumb title="#{msgsAcademicControl['enrollmentRequest.title']}" link="index.xhtml"/>
      <!-- The form to be filled with a selection of researchers and optional start/end years. -->
      <ui:decorate template="/WEB-INF/templates/form.xhtml">
         <ui:param name="formName" value="form" />
         <ui:param name="formLabel" value="#{msgsAcademicControl['enrollmentRequest.form.generateEnrollmentRequest']}" />
         <p:focus />
         <!-- Instructions on how to fill the form. -->	
         <p>
            <h:outputText value="#{msgsAcademicControl['enrollmentRequest.text.instructions']}" />
         </p>
         <!-- Subject offers. -->
         <ui:decorate template="/WEB-INF/templates/formfield.xhtml">
            <ui:param name="fieldName" value="subjectOffers" />
            <ui:param name="label" value="#{msgsAcademicControl['enrollmentRequest.field.listSubjectOffer']}" />
            <p:panelGrid columns="2" layout="grid" columnClasses="ui-grid-col-9,ui-grid-col-3">
               <p:selectOneMenu id="subjectOffers" value="#{enrollmentRequestController.selectOffer}" converter="#{enrollmentRequestController.subjectOfferConverter}"  effect="fade" filter="true" filterMatchMode="startsWith" style="width: 100%" var = "c">
                  <f:selectItem itemLabel="" itemValue="#{null}" />
                  <f:selectItems value="#{enrollmentRequestController.listSubjectOffer}" var="subjectOffer" itemLabel="#{subjectOffer.schoolSubject.name}" itemValue="#{subjectOffer}" />
                  <p:column>
                     <f:facet name="header">
                        <h:outputText value="#{msgsAcademicControl['schoolSubject.field.code']}"/>
                     </f:facet>
                     <h:outputText value="#{c.schoolSubject.code}"/>
                  </p:column>
                  <p:column>
                     <f:facet name="header">
                        <h:outputText value="#{msgsAcademicControl['schoolSubject.title']}"/>
                     </f:facet>
                     <h:outputText value="#{c.schoolSubject.name}"/>
                  </p:column>
                  <p:column>
                     <f:facet name="header">
                        <h:outputText value="#{msgsAcademicControl['subjectOffer.field.professor']}"/>
                     </f:facet>
                     <h:outputText value="#{c.professor.name}"/>
                  </p:column>
                  <p:column>
                     <f:facet name="header">
                        <h:outputText value="#{msgsAcademicControl['schoolSubject.field.workload']}"/>
                     </f:facet>
                     <h:outputText value="#{c.schoolSubject.workload}"/>
                  </p:column>
               </p:selectOneMenu>
               <p:commandButton action="#{enrollmentRequestController.addSubjectOffer}" value="#{msgsAcademicControl['enrollmentRequest.button.addSubjectOffer']}" icon="fa fa-fw fa-plus" update="bgrTable" />
            </p:panelGrid>
            <p:dataTable id="bgrTable" var="bgr" value="#{enrollmentRequestController.listSubjectOfferSelected}" editable="true" editMode="cell" emptyMessage="#{msgsAcademicControl['enrollmentRequest.text.noEnrollmentRequests']}" style="margin-top: 5px;" reflow="true">
               <p:column headerText="#{msgsAcademicControl['schoolSubject.field.code']}" styleClass="ui-grid-col-6">
                  <h:outputText value="#{bgr.schoolSubject.code}" />
               </p:column>
               <p:column headerText="#{msgsAcademicControl['enrollmentRequest.field.subjectOffer']}" styleClass="ui-grid-col-6">
                  <h:outputText value="#{bgr.schoolSubject.name}" />
               </p:column>
               <p:column headerText="#{msgsAcademicControl['subjectOffer.field.professor']}" styleClass="ui-grid-col-6">
                  <h:outputText value="#{bgr.professor.name}" />
               </p:column>
               <p:column headerText="#{msgsAcademicControl['schoolSubject.field.workload']}" styleClass="ui-grid-col-6">
                  <h:outputText value="#{bgr.schoolSubject.workload}" />
               </p:column>
            </p:dataTable>
         </ui:decorate>
         <!-- Buttons below the form. -->
         <ui:decorate template="/WEB-INF/templates/formbuttonpanel.xhtml">
            <p:commandButton id="startOverButton" action="#{enrollmentRequestController.startRequest}" value="#{msgsAcademicControl['enrollmentRequest.button.startOver']}" icon="fa fa-pencil-square-o" update="bgrTable" />
            <p:commandButton id="generateButton" action="#{enrollmentRequestController.generate}" value="#{msgsAcademicControl['enrollmentRequest.form.generate']}" icon="fa fa-fw fa-save" update="bgrTable" />
         </ui:decorate>
      </ui:decorate>
   </ui:define>
</ui:composition>